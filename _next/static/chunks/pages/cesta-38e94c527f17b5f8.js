(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[240],{9264:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cesta",function(){return a(2631)}])},2631:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return m}});var r=a(5893),n=a(570),s=a.n(n),c=a(338),o=a.n(c),i=a(7294);let l=e=>{let t,{cookie:a,cookieCart:n,custDetails:c,setCustDetails:l,cardDetails:d,setCardDetails:u,showPayment:m,setShowPayment:p,submitPayment:h}=e,[_,g]=(0,i.useState)(!0),[x,C]=(0,i.useState)(!1),[N,j]=(0,i.useState)(""),[v,f]=(0,i.useState)(!1);(0,i.useEffect)(()=>g(e=>!Array.isArray(n.cart)||!n.cart.length),[n.cart]),(0,i.useEffect)(()=>C(e=>0!==Object.keys(a.user).length),[a.user]),(0,i.useEffect)(()=>{let e="";x||(e="Necesitas iniciar sesi\xf3n para comprar"),_&&(e="Tu cesta esta vac\xeda"),x&&!_?f(e=>!0):f(e=>!1),j(t=>e)},[_,a.authenticated,x,j]);let y=e=>{p(!0),e.preventDefault()};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("form",{onSubmit:y,className:s().form,children:[(0,r.jsx)("h1",{children:"Realizar pedido"}),(0,r.jsxs)("div",{className:"".concat(s().container)+(m?" ".concat(o().hidden):""),children:[(0,r.jsx)("input",{className:"".concat(s().input," ").concat(s().gridName),type:"text",name:"name",value:c.name,onChange:e=>l({...c,name:e.target.value}),placeholder:"Nombre",required:!0}),(0,r.jsx)("input",{className:"".concat(s().input," ").concat(s().gridLastNames),type:"text",name:"lastname",value:c.lastname,onChange:e=>l({...c,lastname:e.target.value}),placeholder:"Apellido(s)",required:!0}),(0,r.jsx)("input",{className:"".concat(s().input," ").concat(s().gridStreet),type:"text",name:"street",value:c.street,onChange:e=>l({...c,street:e.target.value}),placeholder:"Calle y n\xfamero",required:!0}),(0,r.jsx)("input",{className:"".concat(s().input," ").concat(s().gridPostal),type:"text",name:"postal",value:c.postal,onChange:e=>l({...c,postal:e.target.value}),placeholder:"C\xf3digo Postal",required:!0}),(0,r.jsx)("input",{className:"".concat(s().input," ").concat(s().gridCity),type:"text",name:"city",value:c.city,onChange:e=>l({...c,city:e.target.value}),placeholder:"Ciudad",required:!0}),(0,r.jsx)("input",{className:"".concat(s().input," ").concat(s().gridRegion),type:"text",name:"region",value:c.region,onChange:e=>l({...c,region:e.target.value}),placeholder:"Pa\xeds/Regi\xf3n",required:!0}),(0,r.jsx)("input",{className:"".concat(s().input," ").concat(s().gridEmail),type:"text",name:"email",value:c.email,onChange:e=>l({...c,email:e.target.value}),placeholder:"E-mail",required:!0}),(0,r.jsx)("input",{className:"".concat(s().input," ").concat(s().gridPhone),type:"text",name:"phone",value:c.phone,onChange:e=>l({...c,phone:e.target.value}),placeholder:"N\xfamero de tel\xe9fono",required:!0}),(0,r.jsx)("input",{className:"".concat(s().button," ").concat(s().gridButton),type:"submit",value:"Continuar"})]})]}),(0,r.jsxs)("div",{className:"".concat(s().detailsContainer)+(m?"":" ".concat(o().hidden)),onClick:()=>p(!1),children:[(0,r.jsx)("button",{className:s().editButton,type:"button",children:"Editar"}),(0,r.jsxs)("p",{children:[c.name," ",c.lastname]}),(0,r.jsx)("p",{children:c.street}),(0,r.jsxs)("p",{children:[c.city," ",c.postal," ",c.region]}),(0,r.jsx)("p",{children:c.email}),(0,r.jsx)("p",{children:c.phone})]}),(0,r.jsxs)("form",{onSubmit:h,className:"".concat(s().form)+(m?"":" ".concat(o().hidden)),children:[(0,r.jsxs)("div",{className:s().cardField,children:[(0,r.jsx)("label",{htmlFor:"cardNumber",children:"N\xfamero tarjeta"}),(0,r.jsx)("div",{className:s().cardRow,children:(0,r.jsx)("input",{className:"".concat(s().input," ").concat(s().cardNumber),type:"number",name:"cardNumber",value:d.number,onChange:e=>u({...d,number:isNaN(e.target.valueAsNumber)?"":e.target.valueAsNumber}),placeholder:"N\xfamero tarjeta",maxLength:"16",required:!0})})]}),(0,r.jsxs)("div",{className:s().cardField,children:[(0,r.jsx)("label",{children:"Caducidad"}),(0,r.jsxs)("div",{className:s().cardRow,children:[(0,r.jsx)("label",{htmlFor:"month",children:"Mes"}),(0,r.jsx)("input",{className:"".concat(s().input," ").concat(s().date),type:"number",name:"month",value:d.month,onChange:e=>u({...d,month:isNaN(e.target.valueAsNumber)?"":e.target.valueAsNumber}),placeholder:"MM",required:!0}),(0,r.jsx)("label",{htmlFor:"year",children:"A\xf1o"}),(0,r.jsx)("input",{className:"".concat(s().input," ").concat(s().date),type:"number",name:"year",value:d.year,onChange:e=>u({...d,year:isNaN(e.target.valueAsNumber)?"":e.target.valueAsNumber}),placeholder:"AA",required:!0})]})]}),(0,r.jsxs)("div",{className:s().cardField,children:[(0,r.jsx)("label",{htmlFor:"CVC",children:"C\xf3d. Seguridad"}),(0,r.jsx)("div",{className:s().cardRow,children:(0,r.jsx)("input",{className:"".concat(s().input," ").concat(s().cvc),type:"number",name:"CVC",value:d.code,onChange:e=>u({...d,code:isNaN(e.target.valueAsNumber)?"":e.target.valueAsNumber}),placeholder:"CVC",required:!0})})]}),(0,r.jsx)("input",{className:"".concat(s().button),type:"submit",value:"Enviar pago"}),(t=s().error,v&&(t+=" ".concat(o().hidden)),(0,r.jsx)("label",{className:t,children:"".concat(N)}))]})]})},d=e=>{let{cookieCart:t,setCookieCart:a,total:n,setTotal:s}=e,[c,l]=(0,i.useState)([]),[d,u]=(0,i.useState)(0),[m,p]=(0,i.useState)(0);(0,i.useEffect)(()=>l(e=>void 0===t.cart?[]:t.cart),[t.cart]),(0,i.useEffect)(()=>{let e=0;c.length>0&&(e=c.reduce((e,t)=>e+t.price,0)),p(t=>e),u(e=>1),s(e=>m+d)},[c,s,m,d]);let h=e=>{console.log(e);let r=t.cart;r.splice(e,1),a("cart",r,{path:"/",maxAge:3600,sameSite:!0})},_=new Intl.NumberFormat("es-ES",{style:"currency",currency:"EUR"});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h2",{children:"En tu cesta"}),c.length>0?(0,r.jsxs)("ul",{className:"".concat(o().productList," ").concat(o().topMargin),children:[c.map((e,t)=>(0,r.jsxs)("li",{className:"".concat(o().product," ").concat(o().productRow),onClick:()=>h(t),children:[(0,r.jsx)("span",{children:(0,r.jsx)("button",{className:o().productButton,children:e.name})}),(0,r.jsx)("span",{children:_.format(e.price)})]},t.toString())),(0,r.jsxs)("li",{className:"".concat(o().productRow," ").concat(o().topMargin),children:[(0,r.jsx)("span",{children:"Subtotal"}),(0,r.jsx)("span",{children:_.format(m)})]},"subtotal"),(0,r.jsxs)("li",{className:o().productRow,children:[(0,r.jsx)("span",{children:"Gastos de env\xedo estimados"}),(0,r.jsx)("span",{children:_.format(d)})]},"shipping"),(0,r.jsxs)("li",{className:"".concat(o().productRow," ").concat(o().bold),children:[(0,r.jsx)("span",{children:"Total"}),(0,r.jsx)("span",{children:_.format(n)})]},"total")]}):(0,r.jsx)("p",{className:o().topMargin,children:"Tu cesta est\xe1 vacia"})]})},u=e=>{let{cookie:t,cookieCart:a,setCookieCart:n}=e,[s,c]=(0,i.useState)({email:"",name:"",lastname:"",street:"",postal:"",city:"",region:"",phone:""}),[u,m]=(0,i.useState)({number:"",month:"",year:"",code:""}),[p,h]=(0,i.useState)(!1),[_,g]=(0,i.useState)(0),[x,C]=(0,i.useState)(!1);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:o().container,children:[(0,r.jsx)("div",{className:o().contentsContainer,children:(0,r.jsx)(d,{cookieCart:a,setCookieCart:n,total:_,setTotal:g})}),(0,r.jsx)("div",{className:o().formContainer,children:(0,r.jsx)(l,{cookie:t,cookieCart:a,custDetails:s,setCustDetails:c,cardDetails:u,setCardDetails:m,showPayment:p,setShowPayment:h,submitPayment:function(e){var r;e.preventDefault();let n=null===(r=t.user)||void 0===r?void 0:r.id,s=null==a?void 0:a.cart;console.log("PAYMENT DETAILS:"),console.log("User ID: ".concat(n)),console.log("Total: ".concat(_)),console.log("Products:"),console.log(s)}})})]}),(0,r.jsx)("button",{type:"button",onClick:()=>{document.from.submit()},children:"Test"}),(0,r.jsxs)("form",{name:"from",action:"http://localhost:8888/api/pay.php",method:"POST",id:"redsys-form",children:[(0,r.jsx)("input",{type:"hidden",name:"Ds_SignatureVersion",value:"HMAC_SHA256_V1"}),(0,r.jsx)("input",{type:"hidden",name:"Ds_MerchantParameters",value:"eyJEU19NRVJDSEFOVF9BTU9VTlQiOiAiMTQ1IiwiRFNfTUVSQ0hBTlRfQ1VSUkVOQ1kiOiAiOTc4IiwiRFNfTUVSQ0hBTlRfTUVSQ0hBTlRDT0RFIjogIjk5OTAwODg4MSIsIkRTX01FUkNIQU5UX01FUkNIQU5UVVJMIjogImh0dHA6Ly93d3cucHJ1ZWJhLmNvbS91cmxOb3RpZmljYWNpb24ucGhwIiwiRFNfTUVSQ0hBTlRfT1JERVIiOiAiMTQ0NjA2ODU4MSIsIkRTX01FUkNIQU5UX1RFUk1JTkFMIjogIjEiLCJEU19NRVJDSEFOVF9UUkFOU0FDVElPTlRZUEUiOiAiMCIsIkRTX01FUkNIQU5UX1VSTEtPIjogImh0dHA6Ly93d3cucHJ1ZWJhLmNvbS91cmxLTy5waHAiLCJEU19NRVJDSEFOVF9VUkxPSyI6ICJodHRwOi8vd3d3LnBydWViYS5jb20vdXJsT0sucGhwIn0="}),(0,r.jsx)("input",{type:"hidden",name:"Ds_Signature",value:"PqV2+SF6asdasMjXasKJRTh3UIYya1hmU/igHkzhC+R="})]})]})};var m=u},338:function(e){e.exports={topMargin:"Cart_topMargin__sIcaI",bold:"Cart_bold__WlFCB",container:"Cart_container__v66s_",contentsContainer:"Cart_contentsContainer__JrABM",formContainer:"Cart_formContainer___39pd",hidden:"Cart_hidden__9v3_a",productList:"Cart_productList__FGtRh",productRow:"Cart_productRow__yiosr",product:"Cart_product__Xv1yD"}},570:function(e){e.exports={form:"CartForm_form__OfijY",input:"CartForm_input__ySOvj",button:"CartForm_button__FJvZT",editButton:"CartForm_editButton__4Cy5r",gridName:"CartForm_gridName__uNoQA",gridLastNames:"CartForm_gridLastNames__pTv5C",gridStreet:"CartForm_gridStreet__P8H2k",gridPostal:"CartForm_gridPostal__MW_FO",gridCity:"CartForm_gridCity__wqu2O",gridRegion:"CartForm_gridRegion__ubmU6",gridEmail:"CartForm_gridEmail__gYXpj",gridPhone:"CartForm_gridPhone__tzXXo",gridButton:"CartForm_gridButton__f_3CZ",container:"CartForm_container__q1BAk",payContainer:"CartForm_payContainer___Bf6g",detailsContainer:"CartForm_detailsContainer__ysXex",cardField:"CartForm_cardField__c9VYb",cardRow:"CartForm_cardRow__5QxZ4",date:"CartForm_date__xqv7Y",cvc:"CartForm_cvc__qB_sH",error:"CartForm_error__LixR7"}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=9264)}),_N_E=e.O()}]);