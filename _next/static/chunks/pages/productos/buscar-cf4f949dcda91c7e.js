(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[816],{4252:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/productos/buscar",function(){return t(8023)}])},2596:function(e,n,t){"use strict";t.d(n,{Z:function(){return h}});var r=t(5893),o=t(6017),c=t(5675),s=t.n(c),i=t(1664),a=t.n(i),d=t(2923),l=t.n(d),u=t(918),p=t(7294);function h(e){let{categories:n,sortSelection:t=0,count:c=20,showPages:i=!0,predefinedProds:d=[]}=e,h={data:void 0,error:void 0,isLoading:void 0};d.length>0?(h.data=d,h.isLoading=!1):h=(0,o.Z)(!0);let[_,x]=(0,p.useState)([]),[j,f]=(0,p.useState)(1),[m,v]=(0,p.useState)(1),N=(e,n)=>e.price<n.price?1:e.price>n.price?-1:0,g=(e,n)=>e.price<n.price?-1:e.price>n.price?1:0,P=(e,n)=>e.name.localeCompare(n.name),b=(e,n)=>n.name.localeCompare(e.name);(0,p.useEffect)(()=>{if(!h.isLoading){console.log("ran again");let e=[].concat(h.data);if(n&&Object.keys(n).length>0){let t=Object.values(n).filter(e=>e).length;t>0&&(e=e.filter(e=>{for(let t of e.categories)if(n[t])return!0;return!1}))}console.log("sort selection",t),t==u.r.PRECIO_ALTO_BAJO?e.sort(N):t==u.r.PRECIO_BAJO_ALTO?e.sort(g):t==u.r.NOMBRE_AZ?e.sort(P):t==u.r.NOMBRE_ZA&&e.sort(b),v(Math.ceil(e.length/c)),x(e=e.slice((j-1)*c,Math.min(e.length,(j-1)*c)+c))}},[n,c,j,h.data,h.isLoading,t]);let C=()=>{j>1&&f(j-1)},O=()=>{j<m&&f(j+1)};return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:l().productList,children:_.length>0?_.map(e=>(0,r.jsx)("div",{className:l().card,children:(0,r.jsx)(a(),{href:"/productos/?p=".concat(e.url),children:(0,r.jsxs)("div",{className:"",children:[(0,r.jsx)(s(),{src:e.img,alt:"nombre producto",width:1366,height:1911}),(0,r.jsxs)("div",{className:"",children:[(0,r.jsx)("p",{children:(0,r.jsx)("span",{className:l().productName,children:e.name})}),(0,r.jsxs)("p",{children:[e.price," â‚¬"]})]})]})})},e.id)):(0,r.jsx)("h3",{children:"No se encontraron productos"})}),i&&(0,r.jsxs)("div",{className:l().pages,children:[(0,r.jsx)("button",{className:l().button+" "+(j<=1?l().disabled:""),type:"button",onClick:C,children:(0,r.jsx)("span",{children:"<"})}),(0,r.jsx)("div",{children:(0,r.jsx)("span",{children:j})}),(0,r.jsx)("button",{className:l().button+" "+(j>=m?l().disabled:""),type:"button",onClick:O,children:(0,r.jsx)("span",{children:">"})}),(0,r.jsx)("div",{children:(0,r.jsxs)("span",{children:["de ",m]})})]})]})}},9117:function(e,n,t){"use strict";t.d(n,{Z:function(){return j}});var r=t(5893),o=t(7294),c=t(2596),s=t(1210),i=t.n(s),a=t(8029),d=t.n(a);function l(e){let{label:n,options:t,optionsSelected:o,setOptionsSelected:c}=e;return(0,r.jsxs)("div",{className:d().accordionSection,children:[(0,r.jsx)("input",{type:"checkbox",name:"filter-accordion",id:n,className:d().accordionInput,defaultChecked:!0}),(0,r.jsx)("label",{htmlFor:n,className:d().accordionLabel,children:n}),(0,r.jsx)("div",{className:d().accordionContent,children:t.map(e=>(0,r.jsxs)("div",{className:d().option,children:[(0,r.jsx)("input",{type:"checkbox",id:e,checked:o[e],onChange:()=>{c({...o,[e]:!o[e]})}}),(0,r.jsx)("label",{htmlFor:e,children:e})]},e))})]})}var u=t(3763);function p(e){let{selectedCategories:n,setSelectedCategories:t}=e,[c,s]=(0,o.useState)([]),{data:i,error:a,isLoading:p}=(0,u.Z)();return(0,o.useEffect)(()=>{if(p)s([]),t({});else{let e=i.map(e=>e.name);if(s(e),n&&0===Object.keys(n).length){let n=e.reduce((e,n)=>(e[n]=!1,e),{});t(n)}}},[i,p,n,t]),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:d().accordion,children:(0,r.jsx)(l,{label:"Categor\xedas",options:c,optionsSelected:n,setOptionsSelected:t})})})}var h=t(5434),_=t(918);function x(e){let{selection:n,setSelection:t}=e,[c,s]=(0,o.useState)(!0);return(0,r.jsxs)("div",{className:i().dropdown+" "+(c?i().hidden:""),onClick:()=>{s(!c)},children:[(0,r.jsxs)("div",{className:i().dropdownText,children:["Ordenar por: ",(0,r.jsx)("span",{children:_.a[n]})," ",(0,r.jsx)(h.wlS,{className:i().sortIcon})]}),(0,r.jsx)("div",{className:i().dropdownContent,children:(0,r.jsx)("ul",{className:i().list,children:_.a.map((e,o)=>(0,r.jsxs)("li",{children:[(0,r.jsx)("input",{type:"radio",id:o,name:e,value:o,checked:n===o,onChange:e=>{t(e.target.value),s(!0)}}),(0,r.jsx)("label",{htmlFor:o,onClick:()=>{s(!0)},children:e})]},o))})})]})}function j(e){let{predefinedProds:n=[]}=e,[t,s]=(0,o.useState)({}),[a,d]=(0,o.useState)(0);return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:i().productNav,children:[(0,r.jsxs)("div",{className:i().toolbar,children:[(0,r.jsxs)("h3",{children:["Categor\xedas seleccionadas: ",(()=>{let e=Object.keys(t).flatMap(e=>t[e]?[e]:[]);return e.length>0?e.join(", "):"Ninguna"})()]}),(0,r.jsx)(x,{selection:a,setSelection:d})]}),(0,r.jsxs)("div",{className:i().container,children:[(0,r.jsx)("div",{className:i().filters,children:(0,r.jsx)(p,{selectedCategories:t,setSelectedCategories:s})}),(0,r.jsx)("div",{className:i().display,children:(0,r.jsx)(c.Z,{categories:t,sortSelection:a,count:8,predefinedProds:n})})]})]})})}},3763:function(e,n,t){"use strict";t.d(n,{Z:function(){return o}});var r=t(9734);function o(){let{data:e,error:n,isLoading:t}=(0,r.ZP)("/api/listCategories.php",function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];return fetch(...n).then(e=>e.json())});return{data:e,error:n,isLoading:t}}},6017:function(e,n,t){"use strict";t.d(n,{Z:function(){return o}});var r=t(9734);function o(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{data:t,error:o,isLoading:c}=(0,r.ZP)(e?"/api/listProducts.php"+(n?"?category=".concat(n):""):null,function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];return fetch(...n).then(e=>e.json())});return{data:t,error:o,isLoading:c}}},8023:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return u}});var r=t(5893),o=t(1163),c=t(9734),s=t(9008),i=t.n(s),a=t(9117),d=t(2338),l=t.n(d);function u(){let e=(0,o.useRouter)();console.log(e.query);let{data:n,error:t,isLoading:s}=function(e){let{data:n,error:t,isLoading:r}=(0,c.ZP)("/api/searchProduct.php?p="+e,function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];return fetch(...n).then(e=>e.json())});return{data:n,error:t,isLoading:r}}(e.query.p);console.log("data",n);let d=(0,r.jsx)(i(),{children:(0,r.jsxs)("title",{children:["Buscar: ",e.query.p]})}),u=(0,r.jsx)(r.Fragment,{});return u=s?(0,r.jsx)("div",{children:"Cargando..."}):e.query.p&&void 0!==n&&n.length>0&&e.query.p.length>0?(0,r.jsxs)("div",{children:[(0,r.jsxs)("span",{children:['Mostrando resultados de: "',e.query.p,'"']}),(0,r.jsx)("div",{className:l().products,children:(0,r.jsx)(a.Z,{predefinedProds:n})})]}):(0,r.jsx)("h3",{children:"Producto no encontrado"}),(0,r.jsxs)(r.Fragment,{children:[d,u]})}},918:function(e,n,t){"use strict";t.d(n,{a:function(){return r},r:function(){return o}});let r=["Precio: alto-bajo","Precio: bajo-alto","Nombre: A-Z","Nombre: Z-A"],o={PRECIO_ALTO_BAJO:0,PRECIO_BAJO_ALTO:1,NOMBRE_AZ:2,NOMBRE_ZA:3}},2338:function(e){e.exports={products:"Buscar_products__lI4EM"}},8029:function(e){e.exports={accordion:"FilterPanel_accordion__3lKYd",accordionSection:"FilterPanel_accordionSection__Qwif9",accordionLabel:"FilterPanel_accordionLabel__1ZeCa",accordionContent:"FilterPanel_accordionContent__euwCQ",accordionInput:"FilterPanel_accordionInput__BilOH",option:"FilterPanel_option__7_p3o"}},2923:function(e){e.exports={productList:"ProductDisplay_productList___apkz",card:"ProductDisplay_card__KBPSo",productName:"ProductDisplay_productName__7mulg",pages:"ProductDisplay_pages__k46b6",button:"ProductDisplay_button__euEwo",disabled:"ProductDisplay_disabled__4Ji2x"}},1210:function(e){e.exports={productNav:"ProductNav_productNav__o1nF4",container:"ProductNav_container__gx_OQ",filters:"ProductNav_filters__58hDr",toolbar:"ProductNav_toolbar__TQP_L",dropdown:"ProductNav_dropdown__EVX_T",dropdownText:"ProductNav_dropdownText__gphw2",dropdownContent:"ProductNav_dropdownContent__JhGi9",hidden:"ProductNav_hidden__uZM1j",sortIcon:"ProductNav_sortIcon__7fCcK",list:"ProductNav_list__GeV4d"}},9008:function(e,n,t){e.exports=t(2636)},1163:function(e,n,t){e.exports=t(6885)}},function(e){e.O(0,[228,734,774,888,179],function(){return e(e.s=4252)}),_N_E=e.O()}]);